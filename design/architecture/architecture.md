# AWS Data Processing Pipeline - Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                AWS CLOUD                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LAMBDA VPC (10.0.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                                              â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚  â”‚   S3 Bucket     â”‚    â”‚                  â”‚    â”‚      Secrets Manager   â”‚ â”‚ â”‚
â”‚ â”‚  â”‚candidate-test-  â”‚    â”‚     LAMBDA       â”‚    â”‚                         â”‚ â”‚ â”‚
â”‚ â”‚  â”‚    input        â”‚    â”‚    FUNCTION      â”‚    â”‚  DB Connection String  â”‚ â”‚ â”‚
â”‚ â”‚  â”‚                 â”‚â”€â”€â”€â–¶â”‚                  â”‚â—„â”€â”€â”€â”‚  Username & Password   â”‚ â”‚ â”‚
â”‚ â”‚  â”‚ CSV files       â”‚    â”‚  â€¢ Process CSV   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚  â”‚ uploaded here   â”‚    â”‚  â€¢ Count rows    â”‚                                â”‚ â”‚
â”‚ â”‚  â”‚                 â”‚    â”‚  â€¢ Insert to RDS â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â€¢ Write output  â”‚    â”‚   S3 Output Bucket     â”‚ â”‚ â”‚
â”‚ â”‚                         â”‚  â€¢ Backup file   â”‚â”€â”€â”€â–¶â”‚ candidate-test-output  â”‚ â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â€¢ Send SNS      â”‚    â”‚                        â”‚ â”‚ â”‚
â”‚ â”‚  â”‚   Backup Bucket     â”‚ â”‚                  â”‚    â”‚ result.json files      â”‚ â”‚ â”‚
â”‚ â”‚  â”‚candidate-test-backupâ”‚â—„â”¤                  â”‚    â”‚ (processing results)   â”‚ â”‚ â”‚
â”‚ â”‚  â”‚                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚  â”‚ backup/timestamp... â”‚                                                    â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚ â”‚
â”‚ â”‚                                    â”‚                                        â”‚ â”‚
â”‚ â”‚                                    â–¼                                        â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚        SNS Topic                â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚    (SHARED TOPIC)               â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚  Email: smartech.devops.test    â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚  @gmail.com                     â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚             â”‚                   â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚             â–¼                   â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚      ğŸ“§ EMAIL NOTIFICATION      â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚         (Success/Failure)       â”‚                                     â”‚  â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚  â”‚ â”‚
â”‚ â”‚                    â–²                                                      â”‚  â”‚ â”‚
â”‚ â”‚                    â”‚                                                      â”‚  â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚   CloudWatch Alarms             â”‚          â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚          â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚          â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚ â”‚Error >0  â”‚ â”‚Dur. >5s â”‚        â”‚          â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚ â”‚Alarm     â”‚ â”‚Alarm    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                           â”‚                                          â”‚
â”‚                                           â”‚ VPC PEERING                              â”‚
â”‚                                           â–¼                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RDS VPC (10.1.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚                                                                               â”‚   â”‚
â”‚ â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚ â”‚                         â”‚         RDS                 â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚     PostgreSQL              â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚                             â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”‚ file_metadata table â”‚   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”‚ - id (SERIAL)       â”‚   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”‚ - filename          â”‚   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”‚ - status            â”‚   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”‚ - timestamp         â”‚   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â”‚ - rows_count        â”‚   â”‚                      â”‚   â”‚
â”‚ â”‚                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                      â”‚   â”‚
â”‚ â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚ â”‚                                                                               â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Terraform Infrastructure Components

### Core Services
- **S3 Buckets**: candidate-test-input, candidate-test-output, candidate-test-backup
- **Lambda Function**: CSV processor with S3 trigger
- **RDS Instance**: PostgreSQL database with VPC and security groups
- **Secrets Manager**: Database credentials storage
- **SNS Topic**: Notifications with email subscription
- **CloudWatch Alarms**: Error and duration monitoring
- **IAM Roles**: Lambda execution role with necessary permissions

### Network Components
- **VPCs**: 
  - Lambda VPC (10.0.0.0/16) - Contains Lambda function and shared resources
  - RDS VPC (10.1.0.0/16) - Isolated database environment
- **VPC Peering**: Cross-VPC connectivity between Lambda and RDS VPCs
- **VPC Endpoints**: Private connectivity to AWS services (S3, Secrets Manager, SNS)
- **Internet Gateway**: Outbound internet access for Lambda VPC
- **Route Tables**: Custom routing for VPC peering and endpoint connectivity
- **Security Groups**: Network-level access control for resources
- **Subnets**: 
  - Private subnets for Lambda and RDS
  - Public subnets for NAT Gateway (if needed)



## Data Flow

1. **Upload**: CSV file uploaded to S3 bucket (candidate-test-input)
2. **Trigger**: S3 event triggers Lambda function automatically
3. **Process**: Lambda reads CSV, counts rows, stores metadata in RDS
4. **Output**: Lambda writes result.json to output bucket (candidate-test-output)
5. **Backup**: Lambda copies file to backup bucket with timestamp
6. **Notify**: Lambda publishes result to SNS â†’ Email sent to interviewer
7. **Monitor**: CloudWatch alarms monitor Lambda errors and duration â†’ Send alerts to SNS
8. **Deploy**: GitHub Actions automatically deploys code changes to Lambda